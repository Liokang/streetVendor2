<%- include('../boilerplate/header') %>

<body style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5;">

<% if(isloggedIn){ %>
<main class="container py-5">

  <div class="row g-4">

    <!-- Cart Section -->
    <div class="col-md-4">
      <div class="cart p-4 bg-white rounded-4 shadow-sm">
        <h2 class="mb-4">Cart Items</h2>

        <div class="d-flex mb-3 gap-2">
          <form action="/clearcart/<%-productId%>" method="post" class="flex-grow-1">
            <button class="btn btn-outline-secondary w-100 rounded-pill">Clear Cart</button>
          </form>
          <a href="/checkout/<%-productId %>" class="flex-grow-1">
            <button class="btn btn-primary w-100 rounded-pill disabled" title="Work in progress">Checkout</button>
          </a>
        </div>

        <div id="cartItems" class="mb-3">
          <ul class="list-unstyled">
            <% for(let i = 0; i < details.cart.length; i++) { %>
              <li class="mb-2">
                <strong>Name:</strong> <%-details.cart[i].product %><br>
                <strong>Quantity:</strong> <%-details.cart[i].quantity %><br>
                <strong>Price:</strong> ₹<%-details.cart[i].price %>
              </li>
              <hr>
            <% } %>
          </ul>
        </div>

        <p class="fw-bold">Total Price: <span id="totalPrice">0 Rupees</span></p>
      </div>
    </div>

    <!-- Products Section -->
    <div class="col-md-8">
      <h2 class="mb-4">Products</h2>
      <form action="/ordernow/vendor/<%-productId %>" method="post">

        <div class="row g-3">
          <% for(let i = 0; i < final.length; i++) { %>
          <div class="col-md-4">
            <div class="product bg-white p-3 rounded-4 text-center shadow-sm h-100 d-flex flex-column justify-content-between">
              <img src="<%= final[i].image %>" alt="<%= final[i].product %>" class="mb-3 rounded-3" style="width:100%; height:120px; object-fit:cover;">
              <div>
                <h5 class="mb-2"><%= final[i].product %></h5>
                <p class="mb-2">Price: ₹<%= final[i].quantity %></p>
                <input type="hidden" name="product" value="<%= final[i].product %>">
                <input type="hidden" name="price" value="<%= final[i].quantity %>">
                <input type="number" name="quantity" class="form-control text-center rounded-pill" value="0" min="0" style="width:70px; margin:0 auto;">
              </div>
            </div>
          </div>
          <% } %>
        </div>

        <div class="mt-4 text-center">
          <button type="submit" class="btn btn-primary rounded-pill px-4 py-2">Add to Cart</button>
        </div>
      </form>
    </div>

  </div>
</main>
<% } else { %>
  <div class="container text-center py-5">
    <h3>Please log in to view your cart.</h3>
    <a href="/login" class="btn btn-primary rounded-pill mt-3">Login</a>
  </div>
<% } %>

<style>
  .cart h2, .products h2 {
    font-weight: 600;
  }
  .cart button:hover, .product button:hover {
    transform: translateY(-2px);
    transition: 0.2s ease-in-out;
  }
  .product img {
    transition: transform 0.2s ease-in-out;
  }
  .product img:hover {
    transform: scale(1.05);
  }
</style>

<%- include('../boilerplate/footer') %>
